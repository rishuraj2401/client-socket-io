(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{114:function(e,t,n){},163:function(e,t,n){},164:function(e,t,n){},196:function(e,t){},198:function(e,t){},216:function(e,t,n){},222:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n.n(c),s=n(19),i=n.n(s),o=(n(163),n(164),n(148)),r=n(16),l=n(23),u=n(8),d=Object(c.createContext)(),j=(n(114),n(231)),m=n(158),b=n(233),h=n(232),f=(n.p,n.p+"static/media/video.e038b670.svg"),g=n(81),O=n.p+"static/media/video-off.81281c31.svg",v=n.p+"static/media/msg_illus.a7fd59ce.svg",p=n.p+"static/media/msg.590bd963.svg",x=n.p+"static/media/share_screen.2998de9b.svg",y=n(234),S=n(235),C=n(108),_=n.n(C),w=n(4),N=Object(g.io)("http://localhost:3001"),k=function(e){var t=e.children,n=Object(c.useState)(!1),a=Object(u.a)(n,2),s=a[0],i=a[1],o=Object(c.useState)(!1),r=Object(u.a)(o,2),j=r[0],m=r[1],b=Object(c.useState)(),h=Object(u.a)(b,2),f=h[0],g=h[1],O=Object(c.useState)([]),v=Object(u.a)(O,2),p=v[0],x=v[1],y=Object(c.useState)(""),S=Object(u.a)(y,2),C=S[0],k=S[1],M=Object(c.useState)({}),R=Object(u.a)(M,2),V=R[0],U=R[1],T=Object(c.useState)(""),I=Object(u.a)(T,2),E=I[0],A=I[1],F=Object(c.useState)(""),D=Object(u.a)(F,2),z=D[0],q=D[1],P=Object(c.useState)(""),B=Object(u.a)(P,2),W=B[0],L=B[1],J=Object(c.useState)(!0),H=Object(u.a)(J,2),K=H[0],G=H[1],Q=Object(c.useState)(),X=Object(u.a)(Q,2),Y=X[0],$=X[1],Z=Object(c.useState)(!0),ee=Object(u.a)(Z,2),te=ee[0],ne=ee[1],ce=Object(c.useState)(),ae=Object(u.a)(ce,2),se=ae[0],ie=ae[1],oe=Object(c.useState)(""),re=Object(u.a)(oe,2),le=re[0],ue=re[1],de=Object(c.useState)(!1),je=Object(u.a)(de,2),me=je[0],be=je[1],he=Object(c.useState)(""),fe=Object(u.a)(he,2),ge=fe[0],Oe=fe[1],ve=Object(c.useState)(""),pe=Object(u.a)(ve,2),xe=pe[0],ye=pe[1],Se=Object(c.useRef)(),Ce=Object(c.useRef)(),_e=Object(c.useRef)(),we=Object(c.useRef)();Object(c.useEffect)((function(){navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(e){g(e),Se.current.srcObject=e})),localStorage.getItem("name")&&k(localStorage.getItem("name")),N.on("me",(function(e){return A(e)})),N.on("endCall",(function(){window.location.reload()})),N.on("updateUserMedia",(function(e){var t=e.type,n=e.currentMediaStatus;if(null!==n||n!==[])switch(t){case"video":$(n);break;case"mic":ie(n);break;default:ie(n[0]),$(n[1])}})),N.on("callUser",(function(e){var t=e.from,n=e.name,c=e.signal;U({isReceivingCall:!0,from:t,name:n,signal:c})})),N.on("msgRcv",(function(e){e.name;var t=e.msg,n=e.sender;ue({value:t,sender:n}),setTimeout((function(){ue({})}),2e3)}))}),[]);return Object(w.jsx)(d.Provider,{value:{otherUser:W,call:V,callAccepted:s,myVideo:Se,userVideo:Ce,stream:f,name:C,setName:k,callEnded:j,me:E,callUser:function(e){var t=new _.a({initiator:!0,trickle:!1,stream:f});L(e),t.on("signal",(function(t){N.emit("callUser",{userToCall:e,signalData:t,from:E,name:C})})),t.on("stream",(function(e){Ce.current.srcObject=e})),N.on("callAccepted",(function(e){var n=e.signal,c=e.userName;i(!0),q(c),t.signal(n),N.emit("updateMyMedia",{type:"both",currentMediaStatus:[te,K]})})),_e.current=t,console.log(_e.current)},leaveCall:function(){m(!0),_e.current.destroy(),N.emit("endCall",{id:W}),window.location.reload()},answerCall:function(){i(!0),L(V.from);var e=new _.a({initiator:!1,trickle:!1,stream:f});e.on("signal",(function(e){N.emit("answerCall",{signal:e,to:V.from,userName:C,type:"both",myMediaStatus:[te,K]})})),e.on("stream",(function(e){Ce.current.srcObject=e})),e.signal(V.signal),_e.current=e,console.log(_e.current)},sendMsg:function(e){N.emit("msgUser",{name:C,to:W,msg:e,sender:C});var t={};t.msg=e,t.type="sent",t.timestamp=Date.now(),t.sender=C,x([].concat(Object(l.a)(p),[t]))},msgRcv:le,chat:p,setChat:x,setMsgRcv:ue,setOtherUser:L,leaveCall1:function(){N.emit("endCall",{id:W})},userName:z,myVdoStatus:K,setMyVdoStatus:G,userVdoStatus:Y,setUserVdoStatus:$,updateVideo:function(){G((function(e){return N.emit("updateMyMedia",{type:"video",currentMediaStatus:!e}),f.getVideoTracks()[0].enabled=!e,!e}))},myMicStatus:te,userMicStatus:se,updateMic:function(){ne((function(e){return N.emit("updateMyMedia",{type:"mic",currentMediaStatus:!e}),f.getAudioTracks()[0].enabled=!e,!e}))},screenShare:me,handleScreenSharing:function(){K?me?we.current.onended():navigator.mediaDevices.getDisplayMedia({cursor:!0}).then((function(e){var t=e.getTracks()[0];_e.current.replaceTrack(_e.current.streams[0].getTracks().find((function(e){return"video"===e.kind})),t,f),t.onended=function(){_e.current.replaceTrack(t,_e.current.streams[0].getTracks().find((function(e){return"video"===e.kind})),f),Se.current.srcObject=f,be(!1)},Se.current.srcObject=e,we.current=t,be(!0)})).catch((function(e){console.log("No stream for sharing")})):xe.error("Turn on your video to share the content",2)},fullScreen:function(e){var t=e.target;t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen()},room:ge,setRoom:Oe,joinRoom:function(){""!==ge&&(N.emit("join_room",ge),console.log(ge,"is joining"))},message:xe,setMessage:ye},children:t})},M=(n(139),n(150)),R=(n(208),n(209),function(){var e=Object(c.useContext)(d),t=(e.call,e.otherUser),n=(e.callAccepted,e.myVideo,e.userVideo,e.stream,e.name,e.setName,e.callEnded,e.me,e.callUser,e.leaveCall,e.answerCall,e.sendMsg,e.msgRcv,e.chat,e.setChat,e.setMsgRcv,e.setOtherUser,e.leaveCall1,e.userName,e.myVdoStatus,e.setMyVdoStatus,e.userVdoStatus,e.setUserVdoStatus,e.updateVideo,e.myMicStatus,e.userMicStatus,e.updateMic,e.screenShare,e.handleScreenSharing,e.fullScreen,e.room,e.setRoom,e.joinRoom,e.message),a=e.setMessage,s=Object(c.useState)(""),i=Object(u.a)(s,2),o=i[0],r=i[1],l=Object(c.useRef)(null),j=function(){N.emit("send_message",{message:n,to:t})},m=(Object(c.useRef)(null),Object(c.useRef)(null)),b=Object(c.useRef)(null);return Object(c.useEffect)((function(){N.on("receive_message",(function(e){r(e.message)}))}),[N]),Object(w.jsxs)("div",{children:[Object(w.jsx)("h1",{children:" Message:"}),Object(w.jsx)("textarea",{id:"code",children:"this"}),";",Object(w.jsx)(M.a,{id:"cod",value:o,ref:l,options:{theme:"dracula",keymap:"sublime",mode:"javascript"},onChange:function(e){!function(e){a(e)}(e)},onKeyUp:function(e){!function(e){var t=e;clearTimeout(m.current),m.current=setTimeout((function(){a(t),console.log("value1:",t),console.log("message1:",n.length,n)}),3),clearTimeout(b.current),b.current=setTimeout((function(){"string"===typeof n&&(console.log("rishu"),j())}),3)}(e)}})]})}),V=j.a.Search,U=function(){var e=Object(c.useContext)(d),t=e.call,n=e.callAccepted,a=e.myVideo,s=e.userVideo,i=e.stream,o=e.name,r=(e.setName,e.callEnded),j=(e.me,e.callUser,e.leaveCall,e.answerCall,e.sendMsg),g=e.msgRcv,C=e.chat,_=e.setChat,k=e.userName,M=e.myVdoStatus,U=(e.screenShare,e.fullScreen),T=e.handleScreenSharing,I=e.userVdoStatus,E=e.updateVideo,A=e.myMicStatus,F=e.userMicStatus,D=e.updateMic,z=(e.setMessage,e.message,e.otherUser,Object(c.useState)("")),q=Object(u.a)(z,2),P=q[0],B=q[1],W=Object(c.useState)(!1),L=Object(u.a)(W,2),J=L[0],H=L[1];N.on("msgRcv",(function(e){e.name;var t=e.msg,n=e.sender,c={};c.msg=t,c.type="rcv",c.sender=n,c.timestamp=Date.now(),_([].concat(Object(l.a)(C),[c]))}));var K=Object(c.useRef)();Object(c.useEffect)((function(){(null===K||void 0===K?void 0:K.current)&&K.current.scrollIntoView({behavior:"smooth"})}),[C]);var G=function(e){H(e)};return Object(c.useEffect)((function(){g.value&&!J&&m.a.open({message:"",description:"".concat(g.sender,": ").concat(g.value),icon:Object(w.jsx)(y.a,{style:{color:"#108ee9"}})})}),[g]),Object(w.jsxs)("div",{className:"grid",children:[Object(w.jsx)(R,{}),Object(w.jsx)("div",{}),i?Object(w.jsxs)("div",{style:{textAlign:"center"},className:"card",id:n&&!r?"video1":"video3",children:[Object(w.jsx)("div",{style:{height:"2rem"},children:Object(w.jsx)("h3",{children:M&&o})}),Object(w.jsxs)("div",{className:"video-avatar-container",children:[Object(w.jsx)("video",{playsInline:!0,muted:!0,onClick:U,ref:a,autoPlay:!0,className:"video-active",style:{opacity:"".concat(M?"1":"0")}}),Object(w.jsx)(b.a,{style:{backgroundColor:"#116",position:"absolute",opacity:"".concat(M?"-1":"2")},size:98,icon:!o&&Object(w.jsx)(S.a,{}),children:o})]}),Object(w.jsxs)("div",{className:"iconsDiv",children:[Object(w.jsx)("div",{className:"icons",onClick:function(){D()},tabIndex:"0",children:Object(w.jsx)("i",{className:"fa fa-microphone".concat(A?"":"-slash"),style:{transform:"scaleX(-1)"},"aria-label":"".concat(A?"mic on":"mic off"),"aria-hidden":"true"})}),n&&!r&&Object(w.jsx)("div",{className:"icons",onClick:function(){H(!J)},tabIndex:"0",children:Object(w.jsx)("img",{src:p,alt:"chat icon"})}),Object(w.jsxs)(h.a,{title:"Chat",footer:null,visible:J,onOk:function(){return G(!1)},onCancel:function(){return G(!1)},style:{maxHeight:"100px"},children:[C.length?Object(w.jsxs)("div",{className:"msg_flex",children:[C.map((function(e){return Object(w.jsx)("div",{className:"sent"===e.type?"msg_sent":"msg_rcv",children:e.msg})})),Object(w.jsx)("div",{ref:K,id:"no_border"})]}):Object(w.jsx)("div",{className:"chat_img_div",children:Object(w.jsx)("img",{src:v,alt:"msg_illus",className:"img_illus"})}),Object(w.jsx)(V,{placeholder:"your message",allowClear:!0,className:"input_msg",enterButton:"Send \ud83d\ude80",onChange:function(e){return B(e.target.value)},value:P,size:"large",onSearch:function(e){e&&e.length&&j(e),B("")}})]}),n&&!r&&Object(w.jsx)("div",{className:"icons",onClick:function(){return T()},tabIndex:"0",children:Object(w.jsx)("img",{src:x,alt:"share screen"})}),Object(w.jsx)("div",{className:"icons",onClick:function(){return E()},tabIndex:"0",children:M?Object(w.jsx)("img",{src:f,alt:"video on icon"}):Object(w.jsx)("img",{src:O,alt:"video off icon"})})]})]}):Object(w.jsxs)("div",{className:"bouncing-loader",children:[Object(w.jsx)("div",{}),Object(w.jsx)("div",{}),Object(w.jsx)("div",{})]}),n&&!r&&s&&Object(w.jsxs)("div",{className:"card2",style:{textAlign:"center"},id:"video2",children:[Object(w.jsx)("div",{style:{height:"2rem"},children:Object(w.jsx)("h3",{children:I&&(t.name||k)})}),Object(w.jsxs)("div",{className:"video-avatar-container",children:[Object(w.jsx)("video",{playsInline:!0,ref:s,onClick:U,autoPlay:!0,className:"video-active",style:{opacity:"".concat(I?"1":"0")}}),Object(w.jsx)(b.a,{style:{backgroundColor:"#116",position:"absolute",opacity:"".concat(I?"-1":"2")},size:98,icon:!(k||t.name)&&Object(w.jsx)(S.a,{}),children:k||t.name}),!F&&Object(w.jsx)("i",{style:{position:"absolute",top:"0",left:"0",padding:"0.3rem",backgroundColor:"#fefefebf"},className:"fad fa-volume-mute fa-2x","aria-hidden":"true","aria-label":"microphone muted"})]})]})]})},T=n(50),I=n(152),E=n(155),A=n.p+"static/media/phone.b2c1ae6b.gif",F=n.p+"static/media/teams.23d1d865.mp3",D=n(24),z=n(147),q=n.p+"static/media/hang.a09ef7b4.svg",P=n(225),B=n(226),W=n(227),L=n(228),J=n(229),H=n(230),K=n(236),G=n(98),Q=n(237),X=function(){var e=Object(c.useState)(""),t=Object(u.a)(e,2),n=t[0],a=t[1],s=Object(c.useState)(!1),i=Object(u.a)(s,2),o=i[0],r=i[1],l=Object(c.useRef)(),m=Object(c.useContext)(d),b=m.call,f=m.callAccepted,g=(m.myVideo,m.userVideo,m.stream,m.name),O=m.setName,v=m.callEnded,p=m.me,x=m.callUser,y=m.leaveCall,C=m.answerCall,_=(m.otherUser,m.setOtherUser),N=m.leaveCall1;m.room,m.setRoom,m.joinRoom,m.setMessage;Object(c.useEffect)((function(){var e,t;o?null===l||void 0===l||null===(t=l.current)||void 0===t||t.play():null===l||void 0===l||null===(e=l.current)||void 0===e||e.pause()}),[o]);return Object(c.useEffect)((function(){b.isReceivingCall&&!f?(r(!0),_(b.from)):r(!1)}),[b.isReceivingCall]),Object(w.jsxs)("div",{className:D.options,children:[Object(w.jsxs)("div",{style:{marginBottom:"0.5rem"},children:[Object(w.jsx)("h2",{children:"Account Info"}),Object(w.jsx)(j.a,{size:"large",placeholder:"Your name",prefix:Object(w.jsx)(S.a,{}),maxLength:15,suffix:Object(w.jsxs)("small",{children:[g.length,"/15"]}),value:g,onChange:function(e){O(e.target.value),localStorage.setItem("name",e.target.value)},className:D.inputgroup}),Object(w.jsxs)("div",{className:D.share_options,children:[Object(w.jsx)(z.CopyToClipboard,{text:p,children:Object(w.jsx)(T.a,{type:"primary",icon:Object(w.jsx)(K.a,{}),className:D.btn,tabIndex:"0",onClick:function(e){I.b.success("Code copied successfully!")},children:"Copy code"})}),Object(w.jsxs)("div",{className:D.share_social,children:[Object(w.jsx)(P.a,{url:"https://video-chat-mihir.vercel.app/",title:'Join this meeting with the given code "'.concat(p,'"\n'),separator:"Link: ",className:D.share_icon,children:Object(w.jsx)(B.a,{size:26,round:!0})}),Object(w.jsx)(W.a,{url:"https://video-chat-mihir.vercel.app/",title:'Join this meeting with the given code "'.concat(p,'"\n'),className:D.share_icon,children:Object(w.jsx)(L.a,{size:26,round:!0})}),Object(w.jsx)(J.a,{url:"https://video-chat-mihir.vercel.app/",title:'Join this meeting with the given code  "'.concat(p,'"\n'),className:D.share_icon,children:Object(w.jsx)(H.a,{size:26,round:!0,className:D.share_border})})]})]})]}),Object(w.jsxs)("div",{style:{marginBottom:"0.5rem"},children:[Object(w.jsx)("h2",{children:"Make a call"}),Object(w.jsx)(j.a,{placeholder:"Enter code to call",size:"large",className:D.inputgroup,value:n,onChange:function(e){a(e.target.value)},style:{marginRight:"0.5rem",marginBottom:"0.5rem"},prefix:Object(w.jsx)(S.a,{className:"site-form-item-icon"}),suffix:Object(w.jsx)(E.a,{title:"Enter code of the other user",children:Object(w.jsx)(G.a,{style:{color:"rgba(0,0,0,.45)"}})})}),f&&!v?Object(w.jsxs)(T.a,{variant:"contained",onClick:y,className:D.hang,tabIndex:"0",children:[Object(w.jsx)("img",{src:q,alt:"hang up",style:{height:"15px"}}),"\xa0 Hang up"]}):Object(w.jsx)(T.a,{type:"primary",icon:Object(w.jsx)(Q.a,{}),onClick:function(){g.length?x(n):I.b.error("Please enter your name to call!")},className:D.btn,tabIndex:"0",children:"Call"})]}),b.isReceivingCall&&!f&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("audio",{src:F,loop:!0,ref:l}),Object(w.jsxs)(h.a,{title:"Incoming Call",visible:o,onOk:function(){r(!1)},onCancel:function(){r(!1),N(),window.location.reload()},footer:null,children:[Object(w.jsx)("div",{style:{display:"flex",justifyContent:"space-around"},children:Object(w.jsxs)("h1",{children:[b.name," is calling you:"," ",Object(w.jsx)("img",{src:A,alt:"phone ringing",className:D.phone,style:{display:"inline-block"}})]})}),Object(w.jsxs)("div",{className:D.btnDiv,children:[Object(w.jsx)(T.a,{variant:"contained",className:D.answer,color:"#29bb89",icon:Object(w.jsx)(Q.a,{}),onClick:function(){C(),l.current.pause()},tabIndex:"0",children:"Answer"}),Object(w.jsx)(T.a,{variant:"contained",className:D.decline,icon:Object(w.jsx)(Q.a,{}),onClick:function(){r(!1),l.current.pause()},tabIndex:"0",children:"Decline"})]})]})]})]})},Y=(n(216),function(){return Object(w.jsx)(w.Fragment,{})}),$=function(){return Object(c.useEffect)((function(){navigator.onLine||alert("Connect to internet!")}),[navigator]),Object(c.useEffect)((function(){for(var e=document.cookie.split(";"),t=0;t<e.length;t++){var n=e[t],c=n.indexOf("="),a=c>-1?n.substr(0,c):n;document.cookie=a+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT"}}),[]),Object(w.jsx)(k,{children:Object(w.jsxs)("div",{className:"App",style:{height:"100%",width:"100%"},children:[Object(w.jsx)(U,{}),Object(w.jsx)(X,{})]})})},Z=(n(217),n(218),function(){return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(o.a,{children:[Object(w.jsx)(r.c,{children:Object(w.jsx)(r.a,{path:"/",component:$})}),Object(w.jsx)(Y,{})]})})}),ee=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,238)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,s=t.getLCP,i=t.getTTFB;n(e),c(e),a(e),s(e),i(e)}))},te=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ne(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}i.a.render(Object(w.jsx)(a.a.StrictMode,{children:Object(w.jsx)(Z,{})}),document.getElementById("root")),ee(),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");te?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var c=n.headers.get("content-type");404===n.status||null!=c&&-1===c.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):ne(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):ne(t,e)}))}}()},24:function(e,t,n){e.exports={options:"Options_options__eiH4x",btn:"Options_btn__n54PV",inputgroup:"Options_inputgroup__3SKg9",btnDiv:"Options_btnDiv__1NEnz",phone:"Options_phone__3j1Cl",answer:"Options_answer__wyB9z",decline:"Options_decline__2SqMj",hang:"Options_hang__K5_Ut",share_options:"Options_share_options__1nDwj",share_social:"Options_share_social__2qHQM",share_icon:"Options_share_icon__32724"}}},[[222,1,2]]]);
//# sourceMappingURL=main.d3663efc.chunk.js.map